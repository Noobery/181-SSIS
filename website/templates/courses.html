{% extends 'layouts.html' %}

{% block content %}

<div class="courses_container">
    <div class="row">
        <div class="col-md-12">
            <div class="d-flex justify-content-between align-items-center">
                <h5>Courses</h5>
                <div class="input-group w-50">
                    <input type="text" class="form-control" placeholder="Search Courses">
                    <div class="input-group-append">
                        <button class="btn btn-primary" type="button">Search</button>
                    </div>
                </div>
                <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addCourseModal">Add Course</button>
            </div>
            <table class="table table-striped">
                <tr>
                    <th>Course Code</th>
                    <th>Course Name</th>
                    <th>College Code</th>
                    <th>College Name</th> <!-- Add the column header for "College Name" -->
                    <th>Action</th>
                </tr>
                
                {% for course in courses %}
                    <tr>
                        <td>{{ course.course_code }}</td> <!-- Update to course_code -->
                        <td>{{ course.course_name }}</td> <!-- Update to course_name -->
                        <td>{{ course.college_code }}</td> <!-- Add a new column for college_code -->
                        <td>
                            {% for college in colleges %}
                                {% if college.code == course.college_code %}
                                    {{ college.name }}
                                {% endif %}
                            {% endfor %}
                        </td>
                        <td>
                            <button type="button" class="btn btn-primary edit-course" data-course-code="{{ course.course_code }}" data-course-name="{{ course.course_name }}" data-college-code="{{ course.college_code }}" data-bs-toggle="modal" data-bs-target="#editCourseModal">Edit</button>
                            <a href="#" class="btn btn-danger delete-course" data-course-code="{{ course.course_code }}">Delete</a>
                        </td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    </div>
</div>

<!-- Add Course Form Modal -->
<div class="modal fade" id="addCourseModal" tabindex="-1" role="dialog" aria-labelledby="addCourseModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <form action="" method="POST">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Course</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="courseCode">Course Code</label>
                        <input type="text" class="form-control" id="courseCode" name="courseCode" placeholder="Input Course Code">
                    </div>
                    <div class="form-group">
                        <label for="courseName">Course Name</label>
                        <input type="text" class="form-control" id="courseName" name="courseName" placeholder="Input Course Name">
                    </div>
                    <div class="form-group">
                        <label for="collegeCode">College</label>
                        <select class="form-select" id="collegeCode" name="collegeCode">
                            {% for college in colleges %}
                                <option value="{{ college.code }}">{{ college.name }} ({{ college.code }})</option> <!-- Add both name and code here -->
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Edit Course Form Modal -->
<div class="modal fade" id="editCourseModal" tabindex="-1" role="dialog" aria-labelledby="editCourseModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <form id="editCourseForm" method="POST">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Course</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="editCourseCode">Course Code</label>
                        <input type="text" class="form-control" id="editCourseCode" name="courseCode" placeholder="Course Code" readonly>
                    </div>
                    <div class="form-group">
                        <label for="editCourseName">Course Name</label>
                        <input type="text" class="form-control" id="editCourseName" name="courseName" placeholder="Course Name">
                    </div>
                    <div class="form-group">
                        <label for="editCollegeCode">College</label>
                        <select class="form-select" id="editCollegeCode" name="collegeCode">
                            {% for college in colleges %}
                                <option value="{{ college.code }}">{{ college.name }} ({{ college.code }})</option> <!-- Add both name and code here -->
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary" id="editCourseButton">Save changes</button>
                </div>
            </div>
        </form>
    </div>
</div>

{% endblock %}
